<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple WebGL Example</title>
</head>
<body>
    <canvas id="myCanvas" width="500" height="500"></canvas>

    <script>
        var canvas = document.getElementById('myCanvas');
        var gl = canvas.getContext('webgl');

        // 顶点着色器程序
        var vsSource = `
            attribute vec4 aVertexPosition;
            void main(void) {
                gl_Position = aVertexPosition;
            }
        `;

        // 片元着色器程序
        var fsSource = `
            precision mediump float;
            void main(void) {
                gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
            }
        `;

        // 编译着色器
        function compileShader(gl, source, type) {
            var shader = gl.createShader(type);
            gl.shaderSource(shader, source);
            gl.compileShader(shader);

            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                console.error('Shader compilation failed: ' + gl.getShaderInfoLog(shader));
                gl.deleteShader(shader);
                return null;
            }

            return shader;
        }

        var vertexShader = compileShader(gl, vsSource, gl.VERTEX_SHADER);
        var fragmentShader = compileShader(gl, fsSource, gl.FRAGMENT_SHADER);

        // 创建着色程序
        var shaderProgram = gl.createProgram();
        gl.attachShader(shaderProgram, vertexShader);
        gl.attachShader(shaderProgram, fragmentShader);
        gl.linkProgram(shaderProgram);

        if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
            console.error('Unable to initialize the shader program: ' + gl.getProgramInfoLog(shaderProgram));
        }

        gl.useProgram(shaderProgram);

        // 设置顶点数据
        var vertices = new Float32Array([
            0.0,  1.0,
           -1.0, -1.0,
            1.0, -1.0,
        ]);

        // 创建缓冲区并将数据写入
        var vertexBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

        // 获取顶点位置属性
        var position = gl.getAttribLocation(shaderProgram, 'aVertexPosition');
        gl.vertexAttribPointer(position, 2, gl.FLOAT, false, 0, 0);
        gl.enableVertexAttribArray(position);

        // 清除并绘制
        gl.clearColor(0.0, 0.0, 0.0, 1.0);
        gl.clear(gl.COLOR_BUFFER_BIT);
        gl.drawArrays(gl.TRIANGLES, 0, 3);

        let position = gl.getAttribLocation(program, 'a_Position');
        let color = gl.getAttribLocation(program, 'a_Color');
        let buffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0]), gl.STATIC_DRAW);

        gl.vertexAttribPointer(position, 3, gl.FLOAT, false, 6 * Float32Array.BYTES_PER_ELEMENT, 0);
        gl.enableVertexAttribArray(position);

        gl.vertexAttribPointer(color, 3, gl.FLOAT, false, 6 * Float32Array.BYTES_PER_ELEMENT, 3 * Float32Array.BYTES_PER_ELEMENT);
        gl.enableVertexAttribArray(color);


        // 获取uniform变量的位置
        var modelViewMatrixLoc = gl.getUniformLocation(shaderProgram, 'uModelViewMatrix');
        var projectionMatrixLoc = gl.getUniformLocation(shaderProgram, 'uProjectionMatrix');
        var colorLoc = gl.getUniformLocation(shaderProgram, 'uColor');

        // 设置uniform变量的值
        gl.uniformMatrix4fv(modelViewMatrixLoc, false, modelViewMatrix);
        gl.uniformMatrix4fv(projectionMatrixLoc, false, projectionMatrix);
        gl.uniform4fv(colorLoc, [1.0, 0.0, 0.0, 1.0]); // 设置颜色为红色

    </script>
</body>
</html>


